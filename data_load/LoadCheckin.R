library(rjson)

json_file <- "yelp_academic_dataset_checkin.json"
con = file(json_file, "r")
input <- readLines(con, -1L)
yelp.checkin <- lapply(X=input,fromJSON)

rm(input);rm(con);rm(json_file)

easy.checkin <- lapply(yelp.checkin, function(x){ return(list(
  x$business_id, if(is.null(x$checkin_info$`9-5`)) NA else x$checkin_info$`9-5`,  if(is.null(x$checkin_info$`7-5`)) NA else x$checkin_info$`7-5`,  if(is.null(x$checkin_info$`13-3`)) NA else x$checkin_info$`13-3`, if(is.null(x$checkin_info$`17-6`)) NA else x$checkin_info$`17-6`, if(is.null(x$checkin_info$`13-0`)) NA else x$checkin_info$`13-0`, if(is.null(x$checkin_info$`17-3`)) NA else x$checkin_info$`17-3`, if(is.null(x$checkin_info$`10-0`)) NA else x$checkin_info$`10-0`, if(is.null(x$checkin_info$`18-4`)) NA else x$checkin_info$`18-4`, if(is.null(x$checkin_info$`14-6`)) NA else x$checkin_info$`14-6`, if(is.null(x$checkin_info$`22-5`)) NA else x$checkin_info$`22-5`, if(is.null(x$checkin_info$`15-1`)) NA else x$checkin_info$`15-1`, if(is.null(x$checkin_info$`15-4`)) NA else x$checkin_info$`15-4`, if(is.null(x$checkin_info$`16-2`)) NA else x$checkin_info$`16-2`, if(is.null(x$checkin_info$`21-4`)) NA else x$checkin_info$`21-4`, if(is.null(x$checkin_info$`13-1`)) NA else x$checkin_info$`13-1`, if(is.null(x$checkin_info$`14-4`)) NA else x$checkin_info$`14-4`, if(is.null(x$checkin_info$`12-5`)) NA else x$checkin_info$`12-5`, if(is.null(x$checkin_info$`12-1`)) NA else x$checkin_info$`12-1`, if(is.null(x$checkin_info$`9-1`)) NA else x$checkin_info$`9-1`,  if(is.null(x$checkin_info$`18-3`)) NA else x$checkin_info$`18-3`, if(is.null(x$checkin_info$`15-2`)) NA else x$checkin_info$`15-2`, if(is.null(x$checkin_info$`8-4`)) NA else x$checkin_info$`8-4`,  if(is.null(x$checkin_info$`17-5`)) NA else x$checkin_info$`17-5`, if(is.null(x$checkin_info$`17-4`)) NA else x$checkin_info$`17-4`, if(is.null(x$checkin_info$`11-2`)) NA else x$checkin_info$`11-2`, if(is.null(x$checkin_info$`12-4`)) NA else x$checkin_info$`12-4`,  if(is.null(x$checkin_info$`10-4`)) NA else x$checkin_info$`10-4`, if(is.null(x$checkin_info$`8-1`)) NA else x$checkin_info$`8-1`,  if(is.null(x$checkin_info$`9-4`)) NA else x$checkin_info$`9-4`,  if(is.null(x$checkin_info$`9-0`)) NA else x$checkin_info$`9-0`,  if(is.null(x$checkin_info$`18-1`)) NA else x$checkin_info$`18-1`, if(is.null(x$checkin_info$`19-6`)) NA else x$checkin_info$`19-6`, if(is.null(x$checkin_info$`7-6`)) NA else x$checkin_info$`7-6`,  if(is.null(x$checkin_info$`11-5`)) NA else x$checkin_info$`11-5`, if(is.null(x$checkin_info$`11-4`)) NA else x$checkin_info$`11-4`, if(is.null(x$checkin_info$`17-2`)) NA else x$checkin_info$`17-2`, if(is.null(x$checkin_info$`6-5`)) NA else x$checkin_info$`6-5`,  if(is.null(x$checkin_info$`12-2`)) NA else x$checkin_info$`12-2`, if(is.null(x$checkin_info$`7-4`)) NA else x$checkin_info$`7-4`,  if(is.null(x$checkin_info$`18-2`)) NA else x$checkin_info$`18-2`, if(is.null(x$checkin_info$`16-1`)) NA else x$checkin_info$`16-1`, if(is.null(x$checkin_info$`19-2`)) NA else x$checkin_info$`19-2`, if(is.null(x$checkin_info$`12-3`)) NA else x$checkin_info$`12-3`, if(is.null(x$checkin_info$`10-6`)) NA else x$checkin_info$`10-6`, if(is.null(x$checkin_info$`13-2`)) NA else x$checkin_info$`13-2`, if(is.null(x$checkin_info$`16-4`)) NA else x$checkin_info$`16-4`, if(is.null(x$checkin_info$`10-5`)) NA else x$checkin_info$`10-5`, if(is.null(x$checkin_info$`20-2`)) NA else x$checkin_info$`20-2`, if(is.null(x$checkin_info$`4-4`)) NA else x$checkin_info$`4-4`,  if(is.null(x$checkin_info$`9-2`)) NA else x$checkin_info$`9-2`,  if(is.null(x$checkin_info$`10-2`)) NA else x$checkin_info$`10-2`, if(is.null(x$checkin_info$`4-0`)) NA else x$checkin_info$`4-0`,   if(is.null(x$checkin_info$`4-1`)) NA else x$checkin_info$`4-1`,  if(is.null(x$checkin_info$`11-6`)) NA else x$checkin_info$`11-6`, if(is.null(x$checkin_info$`11-1`)) NA else x$checkin_info$`11-1`, if(is.null(x$checkin_info$`10-1`)) NA else x$checkin_info$`10-1`, if(is.null(x$checkin_info$`6-6`)) NA else x$checkin_info$`6-6`,  if(is.null(x$checkin_info$`5-1`)) NA else x$checkin_info$`5-1`
  , if(is.null(x$checkin_info$`6-3`)) NA else x$checkin_info$`6-3`,  if(is.null(x$checkin_info$`6-0`)) NA else x$checkin_info$`6-0`,  if(is.null(x$checkin_info$`6-1`)) NA else x$checkin_info$`6-1`,  if(is.null(x$checkin_info$`5-5`)) NA else x$checkin_info$`5-5`,  if(is.null(x$checkin_info$`9-3`)) NA else x$checkin_info$`9-3`,  if(is.null(x$checkin_info$`5-6`)) NA else x$checkin_info$`5-6`,  if(is.null(x$checkin_info$`4-6`)) NA else x$checkin_info$`4-6`,  if(is.null(x$checkin_info$`9-6`)) NA else x$checkin_info$`9-6`,  if(is.null(x$checkin_info$`7-3`)) NA else x$checkin_info$`7-3`,  if(is.null(x$checkin_info$`7-2`)) NA else x$checkin_info$`7-2`,  if(is.null(x$checkin_info$`7-1`)) NA else x$checkin_info$`7-1`,  if(is.null(x$checkin_info$`3-4`)) NA else x$checkin_info$`3-4`,  if(is.null(x$checkin_info$`3-3`)) NA else x$checkin_info$`3-3`,  if(is.null(x$checkin_info$`8-5`)) NA else x$checkin_info$`8-5`,  if(is.null(x$checkin_info$`8-6`)) NA else x$checkin_info$`8-6`,  if(is.null(x$checkin_info$`10-3`)) NA else x$checkin_info$`10-3`, if(is.null(x$checkin_info$`8-2`)) NA else x$checkin_info$`8-2`,  if(is.null(x$checkin_info$`8-3`)) NA else x$checkin_info$`8-3`,  if(is.null(x$checkin_info$`5-4`)) NA else x$checkin_info$`5-4`,  if(is.null(x$checkin_info$`6-2`)) NA else x$checkin_info$`6-2`,   if(is.null(x$checkin_info$`8-0`)) NA else x$checkin_info$`8-0`,  if(is.null(x$checkin_info$`19-4`)) NA else x$checkin_info$`19-4`, if(is.null(x$checkin_info$`13-4`)) NA else x$checkin_info$`13-4`, if(is.null(x$checkin_info$`20-4`)) NA else x$checkin_info$`20-4`, if(is.null(x$checkin_info$`13-5`)) NA else x$checkin_info$`13-5`, if(is.null(x$checkin_info$`15-5`)) NA else x$checkin_info$`15-5`, if(is.null(x$checkin_info$`17-0`)) NA else x$checkin_info$`17-0`, if(is.null(x$checkin_info$`19-5`)) NA else x$checkin_info$`19-5`, if(is.null(x$checkin_info$`15-0`)) NA else x$checkin_info$`15-0`, if(is.null(x$checkin_info$`15-3`)) NA else x$checkin_info$`15-3`, if(is.null(x$checkin_info$`1-5`)) NA else x$checkin_info$`1-5`,  if(is.null(x$checkin_info$`19-0`)) NA else x$checkin_info$`19-0`, if(is.null(x$checkin_info$`19-1`)) NA else x$checkin_info$`19-1`, if(is.null(x$checkin_info$`16-5`)) NA else x$checkin_info$`16-5`, if(is.null(x$checkin_info$`12-0`)) NA else x$checkin_info$`12-0`, if(is.null(x$checkin_info$`4-5`)) NA else x$checkin_info$`4-5`,  if(is.null(x$checkin_info$`18-5`)) NA else x$checkin_info$`18-5`, if(is.null(x$checkin_info$`18-6`)) NA else x$checkin_info$`18-6`, if(is.null(x$checkin_info$`16-6`)) NA else x$checkin_info$`16-6`, if(is.null(x$checkin_info$`14-2`)) NA else x$checkin_info$`14-2`, if(is.null(x$checkin_info$`13-6`)) NA else x$checkin_info$`13-6`, if(is.null(x$checkin_info$`14-5`)) NA else x$checkin_info$`14-5`, if(is.null(x$checkin_info$`14-1`)) NA else x$checkin_info$`14-1`, if(is.null(x$checkin_info$`16-0`)) NA else x$checkin_info$`16-0`, if(is.null(x$checkin_info$`17-1`)) NA else x$checkin_info$`17-1`, if(is.null(x$checkin_info$`5-3`)) NA else x$checkin_info$`5-3`,  if(is.null(x$checkin_info$`20-6`)) NA else x$checkin_info$`20-6`, if(is.null(x$checkin_info$`11-0`)) NA else x$checkin_info$`11-0`, if(is.null(x$checkin_info$`15-6`)) NA else x$checkin_info$`15-6`, if(is.null(x$checkin_info$`3-2`)) NA else x$checkin_info$`3-2`,  if(is.null(x$checkin_info$`19-3`)) NA else x$checkin_info$`19-3`, if(is.null(x$checkin_info$`12-6`)) NA else x$checkin_info$`12-6`, if(is.null(x$checkin_info$`4-2`)) NA else x$checkin_info$`4-2`,  if(is.null(x$checkin_info$`7-0`)) NA else x$checkin_info$`7-0`,  if(is.null(x$checkin_info$`14-0`)) NA else x$checkin_info$`14-0`, if(is.null(x$checkin_info$`6-4`)) NA else x$checkin_info$`6-4`,  if(is.null(x$checkin_info$`16-3`)) NA else x$checkin_info$`16-3`, if(is.null(x$checkin_info$`22-4`)) NA else x$checkin_info$`22-4`, 
  if(is.null(x$checkin_info$`22-1`)) NA else x$checkin_info$`22-1`, if(is.null(x$checkin_info$`23-5`)) NA else x$checkin_info$`23-5`, if(is.null(x$checkin_info$`0-5`)) NA else x$checkin_info$`0-5`,  if(is.null(x$checkin_info$`0-6`)) NA else x$checkin_info$`0-6`,  if(is.null(x$checkin_info$`0-1`)) NA else x$checkin_info$`0-1`,  if(is.null(x$checkin_info$`11-3`)) NA else x$checkin_info$`11-3`, if(is.null(x$checkin_info$`20-5`)) NA else x$checkin_info$`20-5`, if(is.null(x$checkin_info$`21-5`)) NA else x$checkin_info$`21-5`, if(is.null(x$checkin_info$`21-1`)) NA else x$checkin_info$`21-1`, if(is.null(x$checkin_info$`21-2`)) NA else x$checkin_info$`21-2`, if(is.null(x$checkin_info$`21-3`)) NA else x$checkin_info$`21-3`, if(is.null(x$checkin_info$`22-0`)) NA else x$checkin_info$`22-0`, if(is.null(x$checkin_info$`18-0`)) NA else x$checkin_info$`18-0`, if(is.null(x$checkin_info$`14-3`)) NA else x$checkin_info$`14-3`, if(is.null(x$checkin_info$`20-1`)) NA else x$checkin_info$`20-1`, if(is.null(x$checkin_info$`20-3`)) NA else x$checkin_info$`20-3`, if(is.null(x$checkin_info$`23-2`)) NA else x$checkin_info$`23-2`, if(is.null(x$checkin_info$`21-6`)) NA else x$checkin_info$`21-6`, if(is.null(x$checkin_info$`0-4`)) NA else x$checkin_info$`0-4`,  if(is.null(x$checkin_info$`3-5`)) NA else x$checkin_info$`3-5`,  if(is.null(x$checkin_info$`20-0`)) NA else x$checkin_info$`20-0`, if(is.null(x$checkin_info$`22-3`)) NA else x$checkin_info$`22-3`, if(is.null(x$checkin_info$`5-0`)) NA else x$checkin_info$`5-0`,  if(is.null(x$checkin_info$`3-1`)) NA else x$checkin_info$`3-1`,  if(is.null(x$checkin_info$`3-0`)) NA else x$checkin_info$`3-0`,  if(is.null(x$checkin_info$`5-2`)) NA else x$checkin_info$`5-2`,  if(is.null(x$checkin_info$`4-3`)) NA else x$checkin_info$`4-3`,  if(is.null(x$checkin_info$`22-6`)) NA else x$checkin_info$`22-6`, if(is.null(x$checkin_info$`3-6`)) NA else x$checkin_info$`3-6`,  if(is.null(x$checkin_info$`2-6`)) NA else x$checkin_info$`2-6`,  if(is.null(x$checkin_info$`22-2`)) NA else x$checkin_info$`22-2`, if(is.null(x$checkin_info$`1-0`)) NA else x$checkin_info$`1-0`,  if(is.null(x$checkin_info$`21-0`)) NA else x$checkin_info$`21-0`, if(is.null(x$checkin_info$`2-3`)) NA else x$checkin_info$`2-3`,  if(is.null(x$checkin_info$`1-3`)) NA else x$checkin_info$`1-3`,  if(is.null(x$checkin_info$`2-0`)) NA else x$checkin_info$`2-0`,  if(is.null(x$checkin_info$`0-2`)) NA else x$checkin_info$`0-2`,  if(is.null(x$checkin_info$`23-4`)) NA else x$checkin_info$`23-4`, if(is.null(x$checkin_info$`23-0`)) NA else x$checkin_info$`23-0`, if(is.null(x$checkin_info$`2-2`)) NA else x$checkin_info$`2-2`,  if(is.null(x$checkin_info$`2-4`)) NA else x$checkin_info$`2-4`,  if(is.null(x$checkin_info$`23-1`)) NA else x$checkin_info$`23-1`, if(is.null(x$checkin_info$`2-1`)) NA else x$checkin_info$`2-1`,  if(is.null(x$checkin_info$`1-6`)) NA else x$checkin_info$`1-6`,  if(is.null(x$checkin_info$`2-5`)) NA else x$checkin_info$`2-5`,  if(is.null(x$checkin_info$`23-6`)) NA else x$checkin_info$`23-6`, if(is.null(x$checkin_info$`0-3`)) NA else x$checkin_info$`0-3`,  if(is.null(x$checkin_info$`1-2`)) NA else x$checkin_info$`1-2`,  if(is.null(x$checkin_info$`1-4`)) NA else x$checkin_info$`1-4`,  if(is.null(x$checkin_info$`23-3`)) NA else x$checkin_info$`23-3`, if(is.null(x$checkin_info$`1-1`)) NA else x$checkin_info$`1-1`,  if(is.null(x$checkin_info$`0-0`)) NA else x$checkin_info$`0-0`
  ))})

df.checkin <-data.frame(matrix(unlist(easy.checkin), ncol=169,byrow=T))
names(df.checkin) <- c('business_id',   "9-Friday",  "7-Friday",  "13-Wednesday", "17-Saturday", "13-Sunday", "17-Wednesday", "10-Sunday", "18-Thursday", "14-Saturday", "22-Friday", "15-Monday", "15-Thursday", "16-Tuesday", "21-Thursday", "13-Monday", "14-Thursday", "12-Friday", "12-Monday", "9-Monday",  "18-Wednesday", "15-Tuesday", "8-Thursday",  "17-Friday", "17-Thursday", "11-Tuesday", "12-Thursday", "10-Thursday", "8-Monday",  "9-Thursday",  "9-Sunday",  "18-Monday", "19-Saturday", "7-Saturday",  "11-Friday", "11-Thursday", "17-Tuesday", "6-Friday",  "12-Tuesday", "7-Thursday",  "18-Tuesday", "16-Monday", "19-Tuesday", "12-Wednesday", "10-Saturday", "13-Tuesday", "16-Thursday", "10-Friday", "20-Tuesday", "4-Thursday",  "9-Tuesday",  "10-Tuesday", "4-Sunday",  "4-Monday",  "11-Saturday", "11-Monday", "10-Monday", "6-Saturday",  "5-Monday",  "6-Wednesday",  "6-Sunday",  "6-Monday",  "5-Friday",  "9-Wednesday",  "5-Saturday",  "4-Saturday",  "9-Saturday",  "7-Wednesday",  "7-Tuesday",  "7-Monday",  "3-Thursday",  "3-Wednesday",  "8-Friday",  "8-Saturday",  "10-Wednesday", "8-Tuesday",  "8-Wednesday",  "5-Thursday",  "6-Tuesday",  "8-Sunday",  "19-Thursday", "13-Thursday", "20-Thursday", "13-Friday", "15-Friday", "17-Sunday", "19-Friday", "15-Sunday", "15-Wednesday", "1-Friday",  "19-Sunday", "19-Monday", "16-Friday", "12-Sunday", "4-Friday",  "18-Friday", "18-Saturday", "16-Saturday", "14-Tuesday", "13-Saturday", "14-Friday", "14-Monday", "16-Sunday", "17-Monday", "5-Wednesday", "20-Saturday", "11-Sunday", "15-Saturday", "3-Tuesday",  "19-Wednesday", "12-Saturday", "4-Tuesday",  "7-Sunday",  "14-Sunday", "6-Thursday",  "16-Wednesday", "22-Thursday", "22-Monday", "23-Friday", "0-Friday",  "0-Saturday",  "0-Monday",  "11-Wednesday", "20-Friday", "21-Friday", "21-Monday", "21-Tuesday", "21-Wednesday", "22-Sunday", "18-Sunday", "14-Wednesday","20-Monday", "20-Wednesday", "23-Tuesday", "21-Saturday", "0-Thursday",  "3-Friday",  "20-Sunday", "22-Wednesday", "5-Sunday",  "3-Monday",  "3-Sunday",  "5-Tuesday",  "4-Wednesday",  "22-Saturday", "3-Saturday",  "2-Saturday",  "22-Tuesday", "1-Sunday",  "21-Sunday", "2-Wednesday",  "1-Wednesday",  "2-Sunday",  "0-Tuesday",  "23-Thursday", "23-Sunday", "2-Tuesday", "2-Thursday",  "23-Monday", "2-Monday",  "1-Saturday",  "2-Friday",  "23-Saturday", "0-Wednesday",  "1-Tuesday",  "1-Thursday",  "23-Wednesday", "1-Monday",  "0-Sunday")

write.table(df.checkin, 'checkins.tsv',sep='\t',row.names=F)

rm(df.checkin);rm(easy.checkin);rm(yelp.checkin)
